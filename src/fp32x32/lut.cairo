use fixed::fixed::traits::LutTrait;

pub impl FP32X32Lut of LutTrait<u64> {
    fn lut_msb(self: u64) -> (u64, u64) {
        if self < 256 {
            if self < 2 {
                (0, 1)
            } else if self < 4 {
                (1, 2)
            } else if self < 8 {
                (2, 4)
            } else if self < 16 {
                (3, 8)
            } else if self < 32 {
                (4, 16)
            } else if self < 64 {
                (5, 32)
            } else if self < 128 {
                (6, 64)
            } else {
                (7, 128)
            }
        } else if self < 65536 {
            if self < 512 {
                (8, 256)
            } else if self < 1024 {
                (9, 512)
            } else if self < 2048 {
                (10, 1024)
            } else if self < 4096 {
                (11, 2048)
            } else if self < 8192 {
                (12, 4096)
            } else if self < 16384 {
                (13, 8192)
            } else if self < 32768 {
                (14, 16384)
            } else {
                (15, 32768)
            }
        } else if self < 16777216 {
            if self < 131072 {
                (16, 65536)
            } else if self < 262144 {
                (17, 131072)
            } else if self < 524288 {
                (18, 262144)
            } else if self < 1048576 {
                (19, 524288)
            } else if self < 2097152 {
                (20, 1048576)
            } else if self < 4194304 {
                (21, 2097152)
            } else if self < 8388608 {
                (22, 4194304)
            } else {
                (23, 8388608)
            }
        } else {
            if self < 33554432 {
                (24, 16777216)
            } else if self < 67108864 {
                (25, 33554432)
            } else if self < 134217728 {
                (26, 67108864)
            } else if self < 268435456 {
                (27, 134217728)
            } else if self < 536870912 {
                (28, 268435456)
            } else if self < 1073741824 {
                (29, 536870912)
            } else if self < 2147483648 {
                (30, 1073741824)
            } else if self < 4294967296 {
                (31, 2147483648)
            } else {
                (32, 4294967296)
            }
        }
    }
    fn lut_exp2(self: u64) -> u64 {
        match self {
            0 => 1,
            1 => 2,
            2 => 4,
            3 => 8,
            4 => 16,
            5 => 32,
            6 => 64,
            7 => 128,
            8 => 256,
            9 => 512,
            10 => 1024,
            11 => 2048,
            12 => 4096,
            13 => 8192,
            14 => 16384,
            15 => 32768,
            16 => 65536,
            17 => 131072,
            18 => 262144,
            19 => 524288,
            20 => 1048576,
            21 => 2097152,
            22 => 4194304,
            23 => 8388608,
            24 => 16777216,
            25 => 33554432,
            26 => 67108864,
            27 => 134217728,
            28 => 268435456,
            29 => 536870912,
            30 => 1073741824,
            31 => 2147483648,
            32 => 4294967296,
            _ => panic!("lut_exp2: out of range"),
        }
    }
    fn lut_sin(self: u64) -> (u64, u64, u64) {
        match self / 26353589 {
            0 => (0, 0, 26353424),
            1 => (26353589, 26353424, 52705856),
            2 => (52707179, 52705856, 79056303),
            3 => (79060768, 79056303, 105403774),
            4 => (105414357, 105403774, 131747276),
            5 => (131767946, 131747276, 158085819),
            6 => (158121536, 158085819, 184418409),
            7 => (184475125, 184418409, 210744057),
            8 => (210828714, 210744057, 237061769),
            9 => (237182303, 237061769, 263370557),
            10 => (263535893, 263370557, 289669429),
            11 => (289889482, 289669429, 315957395),
            12 => (316243071, 315957395, 342233465),
            13 => (342596660, 342233465, 368496651),
            14 => (368950250, 368496651, 394745962),
            15 => (395303839, 394745962, 420980412),
            16 => (421657428, 420980412, 447199012),
            17 => (448011018, 447199012, 473400776),
            18 => (474364607, 473400776, 499584716),
            19 => (500718196, 499584716, 525749847),
            20 => (527071785, 525749847, 551895183),
            21 => (553425375, 551895183, 578019742),
            22 => (579778964, 578019742, 604122538),
            23 => (606132553, 604122538, 630202589),
            24 => (632486142, 630202589, 656258914),
            25 => (658839732, 656258914, 682290530),
            26 => (685193321, 682290530, 708296459),
            27 => (711546910, 708296459, 734275721),
            28 => (737900499, 734275721, 760227338),
            29 => (764254089, 760227338, 786150333),
            30 => (790607678, 786150333, 812043729),
            31 => (816961267, 812043729, 837906553),
            32 => (843314857, 837906553, 863737830),
            33 => (869668446, 863737830, 889536587),
            34 => (896022035, 889536587, 915301854),
            35 => (922375624, 915301854, 941032661),
            36 => (948729214, 941032661, 966728038),
            37 => (975082803, 966728038, 992387019),
            38 => (1001436392, 992387019, 1018008636),
            39 => (1027789981, 1018008636, 1043591926),
            40 => (1054143571, 1043591926, 1069135926),
            41 => (1080497160, 1069135926, 1094639673),
            42 => (1106850749, 1094639673, 1120102207),
            43 => (1133204338, 1120102207, 1145522571),
            44 => (1159557928, 1145522571, 1170899806),
            45 => (1185911517, 1170899806, 1196232957),
            46 => (1212265106, 1196232957, 1221521071),
            47 => (1238618696, 1221521071, 1246763195),
            48 => (1264972285, 1246763195, 1271958380),
            49 => (1291325874, 1271958380, 1297105676),
            50 => (1317679463, 1297105676, 1322204136),
            51 => (1344033053, 1322204136, 1347252816),
            52 => (1370386642, 1347252816, 1372250773),
            53 => (1396740231, 1372250773, 1397197066),
            54 => (1423093820, 1397197066, 1422090755),
            55 => (1449447410, 1422090755, 1446930903),
            56 => (1475800999, 1446930903, 1471716574),
            57 => (1502154588, 1471716574, 1496446837),
            58 => (1528508177, 1496446837, 1521120759),
            59 => (1554861767, 1521120759, 1545737412),
            60 => (1581215356, 1545737412, 1570295869),
            61 => (1607568945, 1570295869, 1594795204),
            62 => (1633922535, 1594795204, 1619234497),
            63 => (1660276124, 1619234497, 1643612827),
            64 => (1686629713, 1643612827, 1667929275),
            65 => (1712983302, 1667929275, 1692182927),
            66 => (1739336892, 1692182927, 1716372869),
            67 => (1765690481, 1716372869, 1740498191),
            68 => (1792044070, 1740498191, 1764557983),
            69 => (1818397659, 1764557983, 1788551342),
            70 => (1844751249, 1788551342, 1812477362),
            71 => (1871104838, 1812477362, 1836335144),
            72 => (1897458427, 1836335144, 1860123788),
            73 => (1923812016, 1860123788, 1883842400),
            74 => (1950165606, 1883842400, 1907490086),
            75 => (1976519195, 1907490086, 1931065957),
            76 => (2002872784, 1931065957, 1954569124),
            77 => (2029226374, 1954569124, 1977998702),
            78 => (2055579963, 1977998702, 2001353810),
            79 => (2081933552, 2001353810, 2024633568),
            80 => (2108287141, 2024633568, 2047837100),
            81 => (2134640731, 2047837100, 2070963532),
            82 => (2160994320, 2070963532, 2094011993),
            83 => (2187347909, 2094011993, 2116981616),
            84 => (2213701498, 2116981616, 2139871536),
            85 => (2240055088, 2139871536, 2162680890),
            86 => (2266408677, 2162680890, 2185408821),
            87 => (2292762266, 2185408821, 2208054473),
            88 => (2319115855, 2208054473, 2230616993),
            89 => (2345469445, 2230616993, 2253095531),
            90 => (2371823034, 2253095531, 2275489241),
            91 => (2398176623, 2275489241, 2297797281),
            92 => (2424530213, 2297797281, 2320018810),
            93 => (2450883802, 2320018810, 2342152991),
            94 => (2477237391, 2342152991, 2364198992),
            95 => (2503590980, 2364198992, 2386155981),
            96 => (2529944570, 2386155981, 2408023134),
            97 => (2556298159, 2408023134, 2429799626),
            98 => (2582651748, 2429799626, 2451484637),
            99 => (2609005337, 2451484637, 2473077351),
            100 => (2635358927, 2473077351, 2494576955),
            101 => (2661712516, 2494576955, 2515982640),
            102 => (2688066105, 2515982640, 2537293599),
            103 => (2714419694, 2537293599, 2558509031),
            104 => (2740773284, 2558509031, 2579628136),
            105 => (2767126873, 2579628136, 2600650120),
            106 => (2793480462, 2600650120, 2621574191),
            107 => (2819834052, 2621574191, 2642399561),
            108 => (2846187641, 2642399561, 2663125446),
            109 => (2872541230, 2663125446, 2683751066),
            110 => (2898894819, 2683751066, 2704275644),
            111 => (2925248409, 2704275644, 2724698408),
            112 => (2951601998, 2724698408, 2745018589),
            113 => (2977955587, 2745018589, 2765235421),
            114 => (3004309176, 2765235421, 2785348143),
            115 => (3030662766, 2785348143, 2805355999),
            116 => (3057016355, 2805355999, 2825258235),
            117 => (3083369944, 2825258235, 2845054101),
            118 => (3109723533, 2845054101, 2864742853),
            119 => (3136077123, 2864742853, 2884323748),
            120 => (3162430712, 2884323748, 2903796051),
            121 => (3188784301, 2903796051, 2923159027),
            122 => (3215137891, 2923159027, 2942411948),
            123 => (3241491480, 2942411948, 2961554089),
            124 => (3267845069, 2961554089, 2980584729),
            125 => (3294198658, 2980584729, 2999503152),
            126 => (3320552248, 2999503152, 3018308645),
            127 => (3346905837, 3018308645, 3037000500),
            128 => (3373259426, 3037000500, 3055578014),
            129 => (3399613015, 3055578014, 3074040487),
            130 => (3425966605, 3074040487, 3092387225),
            131 => (3452320194, 3092387225, 3110617535),
            132 => (3478673783, 3110617535, 3128730733),
            133 => (3505027372, 3128730733, 3146726136),
            134 => (3531380962, 3146726136, 3164603066),
            135 => (3557734551, 3164603066, 3182360851),
            136 => (3584088140, 3182360851, 3199998822),
            137 => (3610441730, 3199998822, 3217516315),
            138 => (3636795319, 3217516315, 3234912670),
            139 => (3663148908, 3234912670, 3252187232),
            140 => (3689502497, 3252187232, 3269339351),
            141 => (3715856087, 3269339351, 3286368382),
            142 => (3742209676, 3286368382, 3303273682),
            143 => (3768563265, 3303273682, 3320054617),
            144 => (3794916854, 3320054617, 3336710553),
            145 => (3821270444, 3336710553, 3353240863),
            146 => (3847624033, 3353240863, 3369644927),
            147 => (3873977622, 3369644927, 3385922125),
            148 => (3900331211, 3385922125, 3402071844),
            149 => (3926684801, 3402071844, 3418093478),
            150 => (3953038390, 3418093478, 3433986423),
            151 => (3979391979, 3433986423, 3449750080),
            152 => (4005745569, 3449750080, 3465383855),
            153 => (4032099158, 3465383855, 3480887161),
            154 => (4058452747, 3480887161, 3496259414),
            155 => (4084806336, 3496259414, 3511500034),
            156 => (4111159926, 3511500034, 3526608449),
            157 => (4137513515, 3526608449, 3541584088),
            158 => (4163867104, 3541584088, 3556426389),
            159 => (4190220693, 3556426389, 3571134792),
            160 => (4216574283, 3571134792, 3585708745),
            161 => (4242927872, 3585708745, 3600147697),
            162 => (4269281461, 3600147697, 3614451106),
            163 => (4295635050, 3614451106, 3628618433),
            164 => (4321988640, 3628618433, 3642649144),
            165 => (4348342229, 3642649144, 3656542712),
            166 => (4374695818, 3656542712, 3670298613),
            167 => (4401049408, 3670298613, 3683916329),
            168 => (4427402997, 3683916329, 3697395348),
            169 => (4453756586, 3697395348, 3710735162),
            170 => (4480110175, 3710735162, 3723935269),
            171 => (4506463765, 3723935269, 3736995171),
            172 => (4532817354, 3736995171, 3749914379),
            173 => (4559170943, 3749914379, 3762692404),
            174 => (4585524532, 3762692404, 3775328765),
            175 => (4611878122, 3775328765, 3787822988),
            176 => (4638231711, 3787822988, 3800174601),
            177 => (4664585300, 3800174601, 3812383140),
            178 => (4690938889, 3812383140, 3824448145),
            179 => (4717292479, 3824448145, 3836369162),
            180 => (4743646068, 3836369162, 3848145741),
            181 => (4769999657, 3848145741, 3859777440),
            182 => (4796353247, 3859777440, 3871263820),
            183 => (4822706836, 3871263820, 3882604450),
            184 => (4849060425, 3882604450, 3893798902),
            185 => (4875414014, 3893798902, 3904846754),
            186 => (4901767604, 3904846754, 3915747591),
            187 => (4928121193, 3915747591, 3926501002),
            188 => (4954474782, 3926501002, 3937106583),
            189 => (4980828371, 3937106583, 3947563934),
            190 => (5007181961, 3947563934, 3957872662),
            191 => (5033535550, 3957872662, 3968032378),
            192 => (5059889139, 3968032378, 3978042699),
            193 => (5086242728, 3978042699, 3987903250),
            194 => (5112596318, 3987903250, 3997613658),
            195 => (5138949907, 3997613658, 4007173558),
            196 => (5165303496, 4007173558, 4016582591),
            197 => (5191657086, 4016582591, 4025840401),
            198 => (5218010675, 4025840401, 4034946641),
            199 => (5244364264, 4034946641, 4043900968),
            200 => (5270717853, 4043900968, 4052703044),
            201 => (5297071443, 4052703044, 4061352537),
            202 => (5323425032, 4061352537, 4069849124),
            203 => (5349778621, 4069849124, 4078192482),
            204 => (5376132210, 4078192482, 4086382299),
            205 => (5402485800, 4086382299, 4094418266),
            206 => (5428839389, 4094418266, 4102300081),
            207 => (5455192978, 4102300081, 4110027446),
            208 => (5481546567, 4110027446, 4117600071),
            209 => (5507900157, 4117600071, 4125017671),
            210 => (5534253746, 4125017671, 4132279966),
            211 => (5560607335, 4132279966, 4139386683),
            212 => (5586960925, 4139386683, 4146337555),
            213 => (5613314514, 4146337555, 4153132319),
            214 => (5639668103, 4153132319, 4159770720),
            215 => (5666021692, 4159770720, 4166252509),
            216 => (5692375282, 4166252509, 4172577440),
            217 => (5718728871, 4172577440, 4178745276),
            218 => (5745082460, 4178745276, 4184755784),
            219 => (5771436049, 4184755784, 4190608739),
            220 => (5797789639, 4190608739, 4196303920),
            221 => (5824143228, 4196303920, 4201841112),
            222 => (5850496817, 4201841112, 4207220108),
            223 => (5876850406, 4207220108, 4212440704),
            224 => (5903203996, 4212440704, 4217502704),
            225 => (5929557585, 4217502704, 4222405917),
            226 => (5955911174, 4222405917, 4227150159),
            227 => (5982264764, 4227150159, 4231735252),
            228 => (6008618353, 4231735252, 4236161021),
            229 => (6034971942, 4236161021, 4240427302),
            230 => (6061325531, 4240427302, 4244533933),
            231 => (6087679121, 4244533933, 4248480760),
            232 => (6114032710, 4248480760, 4252267634),
            233 => (6140386299, 4252267634, 4255894413),
            234 => (6166739888, 4255894413, 4259360959),
            235 => (6193093478, 4259360959, 4262667143),
            236 => (6219447067, 4262667143, 4265812840),
            237 => (6245800656, 4265812840, 4268797931),
            238 => (6272154245, 4268797931, 4271622305),
            239 => (6298507835, 4271622305, 4274285855),
            240 => (6324861424, 4274285855, 4276788480),
            241 => (6351215013, 4276788480, 4279130086),
            242 => (6377568603, 4279130086, 4281310585),
            243 => (6403922192, 4281310585, 4283329896),
            244 => (6430275781, 4283329896, 4285187942),
            245 => (6456629370, 4285187942, 4286884652),
            246 => (6482982960, 4286884652, 4288419964),
            247 => (6509336549, 4288419964, 4289793820),
            248 => (6535690138, 4289793820, 4291006167),
            249 => (6562043727, 4291006167, 4292056960),
            250 => (6588397317, 4292056960, 4292946160),
            251 => (6614750906, 4292946160, 4293673732),
            252 => (6641104495, 4293673732, 4294239650),
            253 => (6667458084, 4294239650, 4294643893),
            254 => (6693811674, 4294643893, 4294886444),
            255 => (6720165263, 4294886444, 4294967296),
            _ => panic!("lut_sin: out of range"),
        }
    }
    fn lut_atan(self: u64) -> (u64, u64, u64) {
        match self / 30064771 {
            0 => (0, 0, 30064280),
            1 => (30064771, 30064280, 60125614),
            2 => (60129542, 60125614, 90181058),
            3 => (90194313, 90181058, 120227671),
            4 => (120259084, 120227671, 150262518),
            5 => (150323855, 150262518, 180282670),
            6 => (180388626, 180282670, 210285207),
            7 => (210453398, 210285207, 240267219),
            8 => (240518169, 240267219, 270225809),
            9 => (270582940, 270225809, 300158091),
            10 => (300647711, 300158091, 330061199),
            11 => (330712482, 330061199, 359932279),
            12 => (360777253, 359932279, 389768499),
            13 => (390842024, 389768499, 419567044),
            14 => (420906795, 419567044, 449325123),
            15 => (450971566, 449325123, 479039968),
            16 => (481036337, 479039968, 508708834),
            17 => (511101108, 508708834, 538329004),
            18 => (541165879, 538329004, 567897786),
            19 => (571230650, 567897786, 597412520),
            20 => (601295421, 597412520, 626870573),
            21 => (631360193, 626870573, 656269345),
            22 => (661424964, 656269345, 685606269),
            23 => (691489735, 685606269, 714878810),
            24 => (721554506, 714878810, 744084472),
            25 => (751619277, 744084472, 773220790),
            26 => (781684048, 773220790, 802285339),
            27 => (811748819, 802285339, 831275734),
            28 => (841813590, 831275734, 860189625),
            29 => (871878361, 860189625, 889024705),
            30 => (901943132, 889024705, 917778707),
            31 => (932007903, 917778707, 946449406),
            32 => (962072674, 946449406, 975034620),
            33 => (992137445, 975034620, 1003532209),
            34 => (1022202216, 1003532209, 1031940079),
            35 => (1052266988, 1031940079, 1060256178),
            36 => (1082331759, 1060256178, 1088478502),
            37 => (1112396530, 1088478502, 1116605090),
            38 => (1142461301, 1116605090, 1144634029),
            39 => (1172526072, 1144634029, 1172563451),
            40 => (1202590843, 1172563451, 1200391537),
            41 => (1232655614, 1200391537, 1228116512),
            42 => (1262720385, 1228116512, 1255736652),
            43 => (1292785156, 1255736652, 1283250279),
            44 => (1322849927, 1283250279, 1310655762),
            45 => (1352914698, 1310655762, 1337951519),
            46 => (1382979469, 1337951519, 1365136018),
            47 => (1413044240, 1365136018, 1392207771),
            48 => (1443109011, 1392207771, 1419165341),
            49 => (1473173783, 1419165341, 1446007339),
            50 => (1503238554, 1446007339, 1472732422),
            51 => (1533303325, 1472732422, 1499339299),
            52 => (1563368096, 1499339299, 1525826721),
            53 => (1593432867, 1525826721, 1552193491),
            54 => (1623497638, 1552193491, 1578438458),
            55 => (1653562409, 1578438458, 1604560517),
            56 => (1683627180, 1604560517, 1630558611),
            57 => (1713691951, 1630558611, 1656431729),
            58 => (1743756722, 1656431729, 1682178905),
            59 => (1773821493, 1682178905, 1707799220),
            60 => (1803886264, 1707799220, 1733291798),
            61 => (1833951035, 1733291798, 1758655812),
            62 => (1864015806, 1758655812, 1783890474),
            63 => (1894080578, 1783890474, 1808995043),
            64 => (1924145349, 1808995043, 1833968821),
            65 => (1954210120, 1833968821, 1858811150),
            66 => (1984274891, 1858811150, 1883521418),
            67 => (2014339662, 1883521418, 1908099052),
            68 => (2044404433, 1908099052, 1932543520),
            69 => (2074469204, 1932543520, 1956854330),
            70 => (2104533975, 1956854330, 1981031032),
            71 => (2134598746, 1981031032, 2005073211),
            72 => (2164663517, 2005073211, 2028980494),
            73 => (2194728288, 2028980494, 2052752544),
            74 => (2224793059, 2052752544, 2076389061),
            75 => (2254857830, 2076389061, 2099889781),
            76 => (2284922601, 2099889781, 2123254476),
            77 => (2314987373, 2123254476, 2146482953),
            78 => (2345052144, 2146482953, 2169575052),
            79 => (2375116915, 2169575052, 2192530648),
            80 => (2405181686, 2192530648, 2215349647),
            81 => (2435246457, 2215349647, 2238031989),
            82 => (2465311228, 2238031989, 2260577643),
            83 => (2495375999, 2260577643, 2282986611),
            84 => (2525440770, 2282986611, 2305258922),
            85 => (2555505541, 2305258922, 2327394635),
            86 => (2585570312, 2327394635, 2349393839),
            87 => (2615635083, 2349393839, 2371256649),
            88 => (2645699854, 2371256649, 2392983206),
            89 => (2675764625, 2392983206, 2414573679),
            90 => (2705829396, 2414573679, 2436028262),
            91 => (2735894168, 2436028262, 2457347172),
            92 => (2765958939, 2457347172, 2478530652),
            93 => (2796023710, 2478530652, 2499578968),
            94 => (2826088481, 2499578968, 2520492408),
            95 => (2856153252, 2520492408, 2541271281),
            96 => (2886218023, 2541271281, 2561915920),
            97 => (2916282794, 2561915920, 2582426676),
            98 => (2946347565, 2582426676, 2602803920),
            99 => (2976412336, 2602803920, 2623048044),
            _ => panic!("lut_atan: out of range"),
        }
    }
}

